分区（Partitioning，磁盘分区/磁盘切片）是将一个物理磁盘划分为一个或多个逻辑部分（分区）。每个分区可以独立使用、格式化、挂载操作系统或数据文件。

分区表（Partition Table）是磁盘上的一段数据结构，用于描述每个分区的起始位置、大小、类型等信息。

分区类型：
- 主分区（primary partition）：硬盘驱动器的基本组成部分，通常用于安装操作系统和基本文件。MBR 的分区方案限制“一个硬盘最多有四个主分区”。
- 扩展分区（extended partition）：为了克服只有四个主分区的限制，扩展分区允许在其中创建逻辑分区。每个磁盘上只能有一个扩展分区，扩展分区本身不包含数据，而是充当逻辑分区的边界。它扩展了磁盘上分区数量，使其能超过四个。（可以将扩展分区视为新硬盘，它也拥有分区表）
- 逻辑分区（logical partition）：在扩展分区中创建的分区（本质上是扩展分区的细分），扩展分区内的每个逻辑分区的功能与主分区类似，可以在这些逻辑分区中安装操作系统或存储数据。

一个新磁盘的使用步骤：
1. 确认新磁盘设备
```bash
lsblk
sdb         8:16    0   500G 0 disk
```

2. 创建 GPT 分区表
```bash
sudo parted /dev/sdb -- mklabel gpt
```

3. 创建新分区（整个磁盘）
```bash
sudo parted /dev/sdb -- mkpart primary ext4 0% 100%
```

4. 格式化文件系统
```bash
sudo mkfs.ext4 /dev/sdb
```

5. 挂载分区
```bash
sudo mkdir -p /mnt/data
sudo mount /dev/sdb /mnt/data
```

6. 添加到 fstab （开机自动挂载）
```bash
# 获取分区 UUID
sudo blkid /dev/sdb
/dev/sda5: UUID="4ac19951-5c9c-41d5-aba0-5231eaa5d6d2" BLOCK_SIZE="4096" TYPE="ext4" PARTLABEL="lfs" PARTUUID="751ea9c5-4ee1-4282-a6cc-d76fe0f2f22f"

# 编辑 /etc/fstab
sudo vim /etc/fstab


```
磁盘分区方案
- GPT（GUID partition table），是 EFI/UEFI 标准衍生出的一种新的磁盘分区格式。
- MBR（Master Boot Record），主引导记录。

| 特性       | MBR（Master Boot Record） | GPT（GUID Partition Table） |
| -------- | ----------------------- | ------------------------- |
| 最大支持磁盘容量 | 2TB                     | 18EB（极大）                  |
| 最大分区数量   | 4 个主分区（或3主+1扩展）         | 128 个分区（Windows下）         |
| 引导方式     | BIOS                    | UEFI                      |
| 容错性      | 无备份，易损坏                 | 有冗余备份，更安全                 |
| 使用情况     | 传统系统（老式BIOS）            | 现代系统（UEFI引导）              |

分区工具举例：

| 工具              | 系统      | 功能        |
| --------------- | ------- | --------- |
| `fdisk`         | Linux   | 操作MBR分区   |
| `gdisk`         | Linux   | 操作GPT分区   |
| `parted`        | Linux   | 支持MBR/GPT |
| Windows磁盘管理器    | Windows | 图形界面分区工具  |
| DiskGenius、分区助手 | 第三方     | 提供更丰富分区功能 |

如何查看分区表类型？
1. 使用 `parted`
```bash
$ sudo parted /dev/sda print
Model: Realtek RTL9220 (scsi)
Disk /dev/sda: 1000GB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags: 

Number  Start   End    Size    File system     Name  Flags
 1      1049kB  100GB  100GB   ext4
 2      100GB   101GB  1127MB  fat32                 boot, esp
 3      101GB   601GB  500GB   ext4
 4      601GB   633GB  32.0GB  linux-swap(v1)        swap
```
通过 `Partition Table: ` 判断分区表类型：
```bash
Partition Table: msdos  # -> 表示 MBR 分区表
Partition Table: gpt    # -> 表示 GPT 分区表
```

2. 使用 `fdisk`
```bash
$ sudo fdisk -l /dev/sda
Disk /dev/sda: 931.51 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: RTL9220         
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 33553920 bytes
Disklabel type: gpt
Disk identifier: 17195947-FB98-40F9-B9A9-BCBB665987D4

Device          Start        End   Sectors   Size Type
/dev/sda1        2048  195315711 195313664  93.1G Linux filesystem
/dev/sda2   195315712  197517311   2201600     1G EFI System
/dev/sda3   197517312 1174081535 976564224 465.7G Linux filesystem
/dev/sda4  1174081536 1236582399  62500864  29.8G Linux swap
```
通过 `Disklabel type:`  判断分区表类型：
```bash
Disklabel type: dos     # -> MBR
Disklabel type: gpt     # -> GPT
```